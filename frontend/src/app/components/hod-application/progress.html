<div class="modal-header">
    <button type="button" class="btn-close" aria-label="Close" (click)="activeModal.dismiss('Cross click')"></button>
</div>
<div class="row">
    <div class="col-md-12 col-md-offset-3">
        <!-- progressbar -->
        <ul id="progressbar">
            <li [ngClass]="step>=1 ? 'active ' : 'inactive'">Documents</li>
            <li [ngClass]="step>=2 ? 'active' : 'inactive'">Status</li>
            <li [ngClass]="step>=3 && is_scientific ? 'active' : 'inactive'">Add course</li>
            <li [ngClass]="step>=4 ? 'active' : 'inactive'">Schoolarship</li>
        </ul>
        <!-- fieldsets -->
        <fieldset *ngIf="step == 1">
            <div class="modal-body">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th scope="col">Title</th>
                            <th scope="col">Document Name</th>
                            <th scope="col">Status</th>
                        </tr>
                    </thead>
                    <tbody *ngFor="let file of fileInfos">
                        <tr>
                            <td>
                                <p>{{ file.title }}</p>
                            </td>
                            <td>
                                <a href="{{ file.url }}">{{ file.name }}</a>
                            </td>
                            <td>
                                <p *ngIf="file.is_approve"> Accepted </p>
                                <p *ngIf="!file.is_approve"> Rejected </p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </fieldset>


        <form [formGroup]="statusDetail" id="msform">
            <fieldset *ngIf="step == 2">
                <label id="example-radio-group-label">Do you agree this application?</label>
                <mat-radio-group aria-labelledby="example-radio-group-label" formControlName='isAgree'
                    class="example-radio-group" [(ngModel)]="agreeOrNot">
                    <mat-radio-button class="example-radio-button" value="Agree" (click)="isAgree('Agree')"> Agree
                    </mat-radio-button>
                    <mat-radio-button class="example-radio-button" value="Reject" (click)="isAgree('Reject')">Reject
                    </mat-radio-button>
                </mat-radio-group>
                <div *ngIf="status_step && statusDetail.controls.isAgree.errors">
                    <div *ngIf="status.isAgree.errors?.required">Agree is required</div>
                </div>

                <div *ngIf="is_agreed">
                    <h2>Scientific sorusu</h2>
                    <mat-radio-group aria-labelledby="example-radio-group-label" formControlName='isScientific'
                        class="example-radio-group" [(ngModel)]="scientificOrNot">
                        <mat-radio-button class="degree-radio-button" value="Yes" (click)="isScientific('Yes')">
                            Yes
                        </mat-radio-button>
                        <mat-radio-button class="degree-radio-button" value="No" (click)="isScientific('No')">
                            No
                        </mat-radio-button>
                    </mat-radio-group>
                    <div *ngIf="status_step && statusDetail.controls.isScientific.errors">
                        <div *ngIf="status.isScientific.errors?.required">*required</div>
                    </div>
                </div>
            </fieldset>
        </form>


        <form [formGroup]="courseDetails" id="msform">
        <fieldset *ngIf="step == 3">
            <h2>Courses</h2>
            
            <mat-form-field appearance="fill">
                <mat-label>Course Name</mat-label>
                <mat-select [(ngModel)]="selectedCourse" matInput name="course" formControlName="selectedCourse" >
                    <mat-option *ngFor="let course of courseInfos" [value]="course.name">
                        {{course.name}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
            <div *ngIf="addCourse_step && courseDetails.controls.selectedCourse.errors">
                <p *ngIf="course.selectedCourse.errors?.required">Course is required</p>
            </div>
            <p> Selected program: {{selectedCourse}} </p>

            <button mat-flat-button color="primary" (click)="addCourse(selectedCourse , user_id)">Add course</button>

            <table class="table table-striped">
                <thead>
                    <tr>
                        <th scope="col">Course Name</th>
                        <th scope="col">Department Name</th>
                        <th scope="col">Remove</th>
                    </tr>
                </thead>
                <tbody *ngFor="let userCourse of userCourses">
                    <tr>
                        <td>
                            <p>{{ userCourse.name }}</p>
                        </td>
                        <td>
                            <p>{{ userCourse.dept_name }}</p>
                        </td>
                        <td>
                            <button class="btn btn-primary" (click)="removeCourse(userCourse.name , userCourse.app_id)">Delete</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        
        </fieldset>
    </form>

    <form [formGroup]="schoolarShipForm" id="msform">
        <fieldset *ngIf="step == 4">
            <div *ngIf=" schoolarShipForm.controls.schoolarChoice.errors">
                <p *ngIf="schoolar.schoolarChoice.errors?.required">Schoolar is required</p>
            </div>
            <h2>Schoolarship sorusu</h2>
            <mat-radio-group aria-labelledby="example-radio-group-label" formControlName='schoolarChoice'
                        class="example-radio-group" [(ngModel)]="chooseSchoolar">
            <mat-radio-button class="degree-radio-button" value="25">
                25%
            </mat-radio-button>
            <mat-radio-button class="degree-radio-button" value="50">
                50%
            </mat-radio-button>
            <mat-radio-button class="degree-radio-button" value="75">
                75%
            </mat-radio-button>
            <mat-radio-button class="degree-radio-button" value="100">
                100%
            </mat-radio-button>
        </mat-radio-group>
        </fieldset>
    </form>
    </div>
</div>

<div class=" modal-footer">
    <button type="button" class="progresss btn-progress" (click)="activeModal.close('Close click')">Close</button>
    <button (click)="previous()" type="button" name="previous" class="progresss btn-progress"
        value="Previous">Previous</button>
    <button *ngIf="step == 4" (click)="submit()" type="submit" name="submit" class="progresss btn-progress"
        value="Submit">Submit</button>
    <button *ngIf="step != 4 && step != 2" (click)="next()" type="button" name="next" class="progresss btn-progress"
        value="Next">Next</button>
    <div *ngIf="agreeOrNot != null ">
        <button *ngIf="step == 2 && is_agreed" (click)="next()" type="button" name="next" class="progresss btn-progress"
            value="Next">Next</button>
        <button *ngIf="step == 2 && !is_agreed" (click)="reject(user_id)" type="button" name="reject"
            class="progresss btn-progress" value="Reject">Reject</button>
    </div>
</div>